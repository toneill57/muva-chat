name: Check VPS Config

on:
  workflow_dispatch:

jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - name: Check VPS
        uses: appleboy/ssh-action@v1.0.0
        with:
          host: ${{ secrets.PROD_VPS_HOST }}
          username: ${{ secrets.PROD_VPS_USER }}
          key: ${{ secrets.PROD_VPS_SSH_KEY }}
          port: 2244
          script: |
            echo "=== DIRECTORIOS EN /var/www ==="
            ls -la /var/www/

            echo ""
            echo "=== PROCESOS PM2 ==="
            pm2 list

            echo ""
            echo "=== ECOSYSTEM CONFIG PRODUCTION ==="
            find /var/www -name "ecosystem.config.js" -exec echo "File: {}" \; -exec cat {} \;
